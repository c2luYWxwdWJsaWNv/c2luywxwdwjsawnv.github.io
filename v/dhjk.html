<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta name="robots" content="none">
    <meta name="referrer" content="no-referrer">
    <meta name="theme-color" content="black">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/sinalpublico/ply@main/assets/css/player-v3.1.min.css">
    <script src="https://ssl.p.jwpcdn.com/player/v/8.33.2/jwpsrv.js"></script>
    <script src="https://content.jwplatform.com/libraries/KB5zFt7A.js"></script>
    <script> jwplayer.key = 'XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo'; </script>
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        #player {
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            height: 100%;
            width: 100%;
            border: 0;
            overflow: hidden;
        }
    </style>
    <script>
        function getParametroUrl(parametro) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(parametro);
        }

        // Função para capturar o HTML da página externa e encontrar o link do vídeo
        function capturarHTML(urlExterna) {
            const url = "https://corsproxy.io/?url=" + encodeURIComponent(urlExterna); // URL com o proxy

            // Requisição para obter o conteúdo da página externa
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    // Expressão regular para encontrar o valor de src dentro do script
                    const regex = /src\s*:\s*"([^"]+)"/i;
                    const match = data.match(regex);
                    
                    if (match) {
                        // Prefixo que será adicionado à URL
                        const prefixo = "https://choraglobe.icu/";

                        // Concatena o prefixo com o valor de src
                        const urlCompleta = prefixo + match[1];

                        // Configurar o player JWPlayer com a URL do vídeo
                        var playerInstance = jwplayer("player");
                        playerInstance.setup({
                            playlist: [{
                                "sources": [
                                    {
                                        "default": false,
                                        "type": "hls",
                                        "file": urlCompleta,
                                        "label": "0"
                                    }
                                ]
                            }],
                            width: "100%",
                            height: "100%",
                            aspectratio: "16:9",
                            autostart: true,
                            cast: true,
                            sharing: false
                        });

                    } else {
                        console.log("Link do vídeo não encontrado na página.");
                    }
                })
                .catch(error => {
                    console.error('Erro ao capturar HTML da página externa:', error);
                });
        }

        // Chamar a função para capturar o link de vídeo e configurar o player
        document.addEventListener('DOMContentLoaded', function() {
            const urlExterna = getParametroUrl('id');
            if (urlExterna) {
                capturarHTML(urlExterna);
            } else {
                console.log('Parâmetro "id" não encontrado na URL.');
            }
        });
    </script>
</head>
<body>
    <div id="player"></div> <!-- Player JWPlayer aqui -->
</body>
</html>
