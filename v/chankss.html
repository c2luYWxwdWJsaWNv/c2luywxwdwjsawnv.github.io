<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="robots" content="none">
  <meta name="theme-color" content="black">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <script src="https://cdn.jsdelivr.net/npm/disable-devtool@latest"></script>
  <script src="//cdn.jsdelivr.net/npm/@clappr/player@0.8/dist/clappr.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@swarmcloud/hls/p2p-engine.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/sinalpublico/ply@main/assets/css/player-v3.1.min.css">
  <script src="https://content.jwplatform.com/libraries/KB5zFt7A.js"></script>
  <script> jwplayer.key = 'XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo'; </script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    #player {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      height: 100%;
      width: 100%;
      border: 0;
      overflow: hidden;
    }
  </style>
</head>
<body> 
    <div id="player"></div> 
<script>
    function getParametroUrl(parametro) {
      const parametrosUrl = new URLSearchParams(window.location.search);
      return parametrosUrl.get(parametro);
    }

    async function configurarPlayer(codigoUrl) {
      try {
        const urlStream = "https://consoledglobo.vercel.app/" + encodeURIComponent(codigoUrl);
        
        const resposta = await fetch(urlStream);
        const conteudo = await resposta.text();
        
        const expressaoRegular = /https:\/\/[^"]+\.m3u8/i;
        const urlM3u8 = conteudo.match(expressaoRegular);

        if (urlM3u8) {
          const urlStreamM3u8 = urlM3u8[0];

          var playerInstance = jwplayer("player");
          playerInstance.setup({
            playlist: [{
              "sources": [
                {
                  default: false,
                  type: "hls",
                  file: urlStreamM3u8,
                  drm: {
                    fairplay: {}
                  },
                  label: "0"
                }, {
                  default: true,
                  type: "hls",
                  file: urlStreamM3u8,
                  drm: {
                    widevine: {},
                    playready: {}
                  },
                  label: "1"
                }]
            }],
            primary: "html5",
            hlshtml: "true",
            width: "100%",
            height: "100%",
            aspectratio: "16:9",
            stretching: "exactfit",
            autostart: true,
            cast: true,
            hlsjsConfig: {
              debug: false,
              p2pConfig: {
                live: true,
              }
            },
          });
        } else {
          console.error("URL do stream não encontrada na página.");
        }
      } catch (erro) {
        console.error("Erro ao configurar o player:", erro);
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      const parametroId = getParametroUrl('m');
      
      if (parametroId) {
        configurarPlayer(parametroId);
      }
    });
  </script>
</body>
</html>
